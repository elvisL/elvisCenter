<!DOCTYPE html>
<!--
  ~ 版权所有:杭州火图科技有限公司
  ~ 地址:浙江省杭州市滨江区西兴街道阡陌路智慧E谷B幢4楼在地图中查看
  ~
  ~ (c) Copyright Hangzhou Hot Technology Co., Ltd.
  ~ Floor 4,Block B,Wisdom E Valley,Qianmo Road,Binjiang District
  ~ 2013-2016. All rights reserved.
  ~
  -->
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <title>库存预警</title>
    <link href="../resource/3rdParty/css/admin.global.css" rel="stylesheet" type="text/css"
          data-th-href="@{/resource/3rdParty/css/admin.global.css}"/>
    <link href="../resource/3rdParty/css/admin.content.css" rel="stylesheet" type="text/css"
          data-th-href="@{/resource/3rdParty/css/admin.content.css}"/>
    <link href="../resource/3rdParty/jBox/Skins/Green/jbox.css" rel="stylesheet" type="text/css"
          data-th-href="@{/resource/3rdParty/jBox/Skins/Green/jbox.css}"/>
    <link href="../resource/3rdParty/jqueryui/jquery-ui-1.10.3.custom.min.css"
          data-th-href="@{/resource/3rdParty/jqueryui/jquery-ui-1.10.3.custom.min.css}" rel="stylesheet"/>
    <link href="../resource/css/settlements.css" rel="stylesheet" data-th-href="@{/resource/css/settlements.css}"
          type="text/css"/>
    <script type="text/javascript" src="../resource/3rdParty/js/jquery-1.7.2.min.js"
            data-th-src="@{/resource/3rdParty/js/jquery-1.7.2.min.js}"></script>
    <script type="text/javascript" src="../resource/3rdParty/js/jquery.utils.js"
            data-th-src="@{/resource/3rdParty/js/jquery.utils.js}"></script>
    <script type="text/javascript" src="../resource/3rdParty/jBox/jquery.jBox-2.3.min.js"
            data-th-src="@{/resource/3rdParty/jBox/jquery.jBox-2.3.min.js}"></script>
    <script type="text/javascript" src="../resource/3rdParty/js/admin.js"
            data-th-src="@{/resource/3rdParty/js/admin.js}"></script>
    <script src="../resource/3rdParty/jqueryui/jquery-ui-1.8.20.min.js"
            data-th-src="@{/resource/3rdParty/jqueryui/jquery-ui-1.8.20.min.js}"></script>
    <script type="text/javascript" src="../resource/3rdParty/My97DatePicker/WdatePicker.js"
            data-th-src="@{/resource/3rdParty/My97DatePicker/WdatePicker.js}"></script>
</head>
<body>
<form method="post" action="/purchase/showGoodsList" data-th-action="@{/purchase/showGoodsList}" id="form1"
      data-th-object="${goodsSearcher}">




    <div class="container">
        <div class="blank10">
        </div>
        <div class="search block" style="display: block;">
            <div class="h">
                <span class="icon-sprite icon-magnifier"></span>
                <h3>库存预警</h3>
            </div>
            <div class="tl corner">
            </div>
            <div class="tr corner">
            </div>
            <div class="br corner">
            </div>
            <div class="cnt-wp" style="padding: 35px 10px 10px;">
               <!-- <div class="cnt">
                    <div class="search-bar">
                        <div>
                            <label class="first ">商品名称：</label>
                            <input name="goodsName" type="text" data-th-value="*{goodsName}" id="goodsName"
                                   class="input-small" style="width: 120px;"/>
                            <label>
                                <a class="btn-lit btn-middle" onclick="searchSettlement()" style="margin-bottom: 3px;">
                                    <span>查询</span>
                                </a>
                            </label>
                        </div>
                    </div>
                </div>-->
            </div>
        </div>
        <div class="blank10">
        </div>
        <div class="block">
            <div class="tl corner">
            </div>
            <div class="tr corner">
            </div>
            <div class="bl corner">
            </div>
            <div class="br corner">
            </div>
            <div class="cnt-wp" style="padding: 10px 10px 10px;display: block;">
                <div class="cnt">
                    <table class="data-table even1" width="100%" border="0" cellspacing="0" cellpadding="0">
                        <thead>
                        <tr class="even">
                            <th scope="col">序号
                            </th>
                            <th scope="col">商品名称
                            </th>
                         <!--   <th scope="col">规格
                            </th>-->
                            <th scope="col">单价
                            </th>
                            <th scope="col">库存
                            </th>
                            <th scope="col">预警数量
                            </th>
                        </tr>
                        </thead>
                        <tbody data-th-remove="all-but-first">
                        <tr data-th-each="agentProduct,goodsStat:${agentProduct}" class="infotr"
                            data-th-attr="productId=${agentProduct.product.productId},warnig=${agentProduct.warning},agentId=${agentProduct.agent.id}">
                            <td class="txt20 c" data-th-text="${goodsStat.count}">1</td>
                            <td class="txt160 c js_nametd" data-th-text="${agentProduct.product.name}" >
                                商品名称
                            </td>
                           <!-- <td class="txt80 c">
                                ￥<span data-th-text="${product.price}">100</span>
                            </td>-->
                            <td class="txt80 c">
                                ￥<span data-th-text="${agentProduct.product.price}">100</span>
                            </td>
                            <td class="txt80 c" data-th-text="${agentProduct.store}">
                                1000
                            </td>
                            <td class="txt80 c waringtd">
                                <input style="width: 50px;text-align: center;" type="number" value="0" /> <span data-th-text="${agentProduct.warning}" ></span>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
                <!--分页开始-->
                <script type="text/javascript" dtat-th-inline="javascript">
                    /*<![CDATA[*/
                    var pageSize = /*[[${pageSize}]]*/ '-1';
                    var pageIndex = /*[[*{pageNo}]]*/ '-1';
                    var pageCount = /*[[${totalPages}]]*/ '-1';
                    var recordCount = /*[[${totalRecords}]]*/ '-1';
                    var formName = 'form1';
                    //                                    var pageNoStr = 'pageNoStr';
                    Pager.Output(formName, 'pageNo', pageSize, pageIndex, pageCount, recordCount);
                    /*]]>*/
                </script>
                <!--分页结束-->
            </div>
        </div>
        <div style="text-align: center;">
            <a class="btn-lit" href="javascript:save();"><span>保存</span></a>
        </div>
    </div>
</form>
</body>

<script th:inline="javascript">
    /*<![CDATA[*/
    function save() {

        $.jBox.tip("正在保存...", "loading");
        var employees = new Array();
        $('.infotr').each(function(v,i){
/*
            employees.push('{agentId:'+$(this).attr("agentId")+' , productId:'+$(this).attr("productId")+'warning:'+$(this).attr("warnig")+'}');
*/
            employees.push('{'+$(this).attr("agentId")+','+$(this).attr("productId")+','+$(this).attr("warnig")+'}');

        });

 /*       var employees = [
            {'a': 'aa', 'b': 'bb'},
            {'a': 'a1', 'b': 'b1'},
            {'a': 'a2', 'b': 'b2'}
        ]
        var obj = {};
        obj['employees'] = employees;
        console.log(JSON.stringify(obj));
*/

        var info = {};
        info['info']=employees;
        alert(JSON.stringify(info));

        $.ajax({
            type: "POST",
            url: "save",
            contentType:"application/json",
            data: JSON.stringify(info),
            dataType: "json",
            success: function (result) {
                if (result.code == 200) {
                    $.jBox.tip("保存成功", "success");
                } else {
                    $.jBox.tip(result.msg, "error");
                }
            },
            error: function () {
                $.jBox.tip("发生错误", "error");
            }
        });
    }
    /*]]>*/
</script>
</html>